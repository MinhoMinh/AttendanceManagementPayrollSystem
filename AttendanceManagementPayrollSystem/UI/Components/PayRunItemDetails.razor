@using System.Globalization
@using AttendanceManagementPayrollSystem.DTO

@code {
    [Parameter] public PayRunItemDto? Item { get; set; }

    private static readonly CultureInfo viVn = new("vi-VN");
}

@if (Item == null)
{
    <p>Không có dữ liệu.</p>
}
else
{
    <div class="card p-3 mb-3">
        <h4>Mục bảng lương</h4>
        <table class="table table-sm">
            <tr><th>Nhân viên</th><td>@Item.EmpName</td></tr>
            <tr><th>Lương gộp</th><td>@Item.GrossPay.ToString("C0", viVn)</td></tr>
            <tr><th>Khấu trừ</th><td>@Item.Deductions.ToString("C0", viVn)</td></tr>
            <tr><th>Lương thực nhận</th><td>@Item.NetPay.ToString("C0", viVn)</td></tr>
            <tr><th>Ghi chú</th><td>@Item.Notes</td></tr>
        </table>
    </div>

    <div class="card p-3">
        <h5>Thành phần</h5>
        @if (Item.Components == null || !Item.Components.Any())
        {
            <p>Không có thành phần.</p>
        }
        else
        {
            <table class="table table-bordered table-sm">
                <thead>
                    <tr>
                        <th>Loại</th>
                        <th>Mã</th>
                        <th>Mô tả</th>
                        <th>Số tiền</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var c in Item.Components)
                    {
                        var displayAmount = c.ComponentType == "Earning"
                        ? c.Amount
                        : -Math.Abs(c.Amount);

                        <tr>
                            <td>@c.ComponentType</td>
                            <td>@c.ComponentCode</td>
                            <td>@c.Description</td>
                            <td>@displayAmount.ToString("C0", viVn)</td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    </div>
}
